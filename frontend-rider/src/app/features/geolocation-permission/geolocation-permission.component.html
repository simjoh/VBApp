<div class="geolocation-permission-container">
  <div class="permission-card">
    <div class="permission-header">
      <div class="location-icon">
        <i class="pi pi-map-marker"></i>
      </div>
      <h1>Location Access Required</h1>
      <p>This app needs access to your location to provide accurate tracking and navigation features.</p>
    </div>

    <div class="permission-content">
      <div class="benefits-list">
        <h3>Why we need your location:</h3>
        <ul>
          <li>
            <i class="pi pi-check-circle"></i>
            <span>Track your position during the event</span>
          </li>
          <li>
            <i class="pi pi-check-circle"></i>
            <span>Provide accurate distance calculations</span>
          </li>
          <li>
            <i class="pi pi-check-circle"></i>
            <span>Send automatic check-in notifications</span>
          </li>
          <li>
            <i class="pi pi-check-circle"></i>
            <span>Enable geofencing for checkpoints</span>
          </li>
        </ul>
      </div>

      @if (error()) {
        <div class="error-message">
          <i class="pi pi-exclamation-triangle"></i>
          <span>{{ error() }}</span>
        </div>
      }

      @if (permissionGranted()) {
        <div class="success-message">
          @if (isDetectingLocation()) {
            <i class="pi pi-spin pi-spinner"></i>
            <span>Location access granted! Detecting your location...</span>
          } @else {
            <i class="pi pi-check-circle"></i>
            <span>Location access granted! Redirecting to dashboard...</span>
          }
        </div>
      }
    </div>

    <div class="permission-actions">
      @if (!permissionGranted()) {
        <button
          class="permission-button primary"
          (click)="requestPermission()"
          [disabled]="isRequesting()"
        >
          @if (isRequesting()) {
            <i class="pi pi-spin pi-spinner"></i>
            <span>Requesting Permission...</span>
          } @else {
            <i class="pi pi-map-marker"></i>
            <span>Allow Location Access</span>
          }
        </button>

        @if (error()) {
          <button
            class="permission-button secondary"
            (click)="retryPermission()"
            [disabled]="isRequesting()"
          >
            <i class="pi pi-refresh"></i>
            <span>Try Again</span>
          </button>
        }
      }
    </div>

    <div class="permission-footer">
      <p>
        <i class="pi pi-info-circle"></i>
        You can change this permission later in your browser settings
      </p>
    </div>
  </div>
</div>
