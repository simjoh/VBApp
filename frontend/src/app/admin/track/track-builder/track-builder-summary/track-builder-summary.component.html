<p-card header="Arrangemang">
  <ng-container *ngIf="(event$)  | async as s">
    <h5>{{s.title}}</h5>
    {{s.startdate}} - {{s.enddate}}
  </ng-container>
</p-card>

<p-card header="Bana" styleClass="mt-0">
  <ng-container *ngIf="$track | async as track">
    <div class="grid">
      <div class="col-5">
        <h4>{{track.track_title}}</h4>
      </div>
      <div class="col-7">
        <div class="grid">
          <div class="col-4">
            <strong>Distans:</strong> {{track.event_distance}} km
          </div>
          <div class="col-4">
            <strong>Datum:</strong> {{track.start_date}}
          </div>
          <div class="col-4">
            <strong>Tid:</strong> {{track.start_time}}
          </div>
          <div class="col-6">
            <strong>Minimitid:</strong> {{($summary | async)?.rusaTrackRepresentation?.MIN_TIME}}
          </div>
          <div class="col-6">
            <strong>Maximitid:</strong> {{($summary | async)?.rusaTrackRepresentation?.MAX_TIME}}
          </div>
          <div class="col-12" *ngIf="($summary | async)?.rusaTrackRepresentation?.GRAVEL_MAX_TIME">
            <strong>Grus maximitid:</strong> {{($summary | async)?.rusaTrackRepresentation?.GRAVEL_MAX_TIME}}
          </div>
          <div class="col-12">
            <strong>Länk:</strong> {{track.link}}
          </div>
        </div>
      </div>
    </div>
  </ng-container>
</p-card>

<p-card header="Kontroller" styleClass="mt-2" [style.opacity]="(trackSaved$ | async) ? '1' : '0.6'">
  <div *ngIf="!(trackSaved$ | async)" class="flex align-items-center justify-content-center p-3 surface-200 border-round mb-3">
    <i class="pi pi-info-circle mr-2 text-600"></i>
    <span class="text-600">Spara banan först för att hantera kontroller</span>
  </div>

  <ng-container *ngIf="$controls | async as control">
    <hr>
    <ng-container *ngFor="let control of control">
      <div class="mb-2">
        <div class="grid">
          <div class="col-1">
            <p-image width="60" height="60" src="{{control.siteRepresentation.image}}" alt="Image" [preview]="false"></p-image>
          </div>
          <div class="col-11">
            <div class="grid">
              <div class="col-3">
                <strong>Kontroll:</strong> {{control.siteRepresentation.adress}}
              </div>
              <div class="col-3">
                <strong>Distans:</strong> {{control.rusaControlRepresentation.CONTROL_DISTANCE_KM}}km
              </div>
              <div class="col-3">
                <strong>Öppnar:</strong> {{control.rusaControlRepresentation.OPEN}}
              </div>
              <div class="col-3">
                <strong>Stänger:</strong> {{control.rusaControlRepresentation.CLOSE}}
              </div>
              <div class="col-3">
                {{control.rusaControlRepresentation.RELATIVE_OPEN}} {{control.rusaControlRepresentation.RELATIVE_CLOSE}}
              </div>
              <div class="col-9">
                <strong>Service:</strong> {{control.siteRepresentation.description}}
              </div>
            </div>
          </div>
        </div>
      </div>
      <hr>
    </ng-container>
  </ng-container>
</p-card>

<div class="flex justify-content-center mt-2">
  <p-button
    [disabled]="($buttonDisable | async) === true || !(trackSaved$ | async)"
    label="Spara kontroller"
    (onClick)="saveControls()"
    icon="pi pi-map-marker"
    [loading]="saving"
    styleClass="p-button-sm p-button-success">
  </p-button>
</div>

